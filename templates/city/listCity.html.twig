{% extends 'base.html.twig' %}

{% block title %}
	Liste des villes
{% endblock %}

{% block body %}


	<div class="btn-group">

	<button type="button" class="btn btn-light dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">

		{{ app.user. getEmail() }}

	</button>


	<div class="dropdown-menu">
		{% if is_granted('ROLE_ADMIN') %} 
		<a class="dropdown-item" href="{{ path('app_add') }}">Ajouter une ville</a>
		{% endif %}

		<div class="dropdown-divider"></div>
		<a class="dropdown-item" href="{{ path('app_logout') }}">Déconnexion</a>
	</div>
	</div>
	</br>
	</br>
	
	


	<table id="table" class="table table-striped" style="width:100%">
		<thead>
			<tr>
				<th>Ville</th>
				<th>Pays</th>
				<th>Population</th>

				{% if is_granted('ROLE_ADMIN') %} 
				<th>Modifier</th>
				<th>Supprimer</th>
				{% endif %}
			</tr>
		</thead>
		<tbody>
			{% if cities is defined %}
				{% for city in cities %}
					<tr>
						<th scope="row">{{ city.name }}</th>
						<td>{{ city.countrycode.name }}</td>
						<td>{{ city.population }}</td>

						{% if is_granted('ROLE_ADMIN') %}
						<td>
							<a href="{{ path('app_edit', {id: city.id}) }}" class="btn btn-info btn-lg">
								Modifier
							</a>
						</td>
						<td>
							<a href="{{ path('app_delete', {id: city.id}) }}" class="btn btn-danger btn-lg">
								Supprimer
							</a>
						</td>
						{% endif %}
					</tr>
				{% endfor %}
			{% endif %}
		</tbody>

	</table>
{% endblock %}

{% block javascripts %}

	<script>

		$(document).ready(function () {
			$('#table').DataTable({"lengthMenu": [ 10,20 ],"language": 
                    {
                        "emptyTable": "No data available in table",
                        "info":  "de _START_ à _END_ sur _TOTAL_ résultats",
                        "lengthMenu": "Pagination: _MENU_",
                        "search": "Rechercher",
                        "zeroRecords":  "Aucun résultat",
                        "paginate": {
                            "first":      "Premier",
                            "last":       "Dernier",
                            "next":       "Suivant",
                            "previous":   "Précédent",
                    }}
			});
		});
	</script>
	
{% endblock %}
